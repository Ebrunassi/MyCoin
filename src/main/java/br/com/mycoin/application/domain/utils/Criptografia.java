package br.com.mycoin.application.domain.utils;

import java.math.BigInteger;

public class Criptografia {
	
	private static Criptografia cripto;
	private static BigInteger p;	// Primo 1
	private static BigInteger q;	// Primo 2
	private static BigInteger n;	// Primo 1 * Primo 2
	private static BigInteger e;
	private static BigInteger d;
	
	public static Criptografia getInstance() {
		if(Criptografia.cripto == null)
			cripto = new Criptografia();
		return cripto;
	}
	
	private Criptografia() {
		p = new BigInteger("12146250508091912611772496132025681900160821477470128345431981192085459048024876865136815370784817003171103082922644791990030157783289861489041957142488027");
		q = new BigInteger("9568409683358261744526440456714564367448908900755089623437629879505428565072244535117020384664345607598687461394222296992868933459737270883691379097250761");
		e = new BigInteger("3");
		n = new BigInteger("116220300978121863384957944172193206470113768241736248128278892870381585325801936618640778408101972768011567689451868854463460560303526744389764074389778824775435680604264079292486033962564151136175625768752259219743938735072404730912776926552174409909956840387702413214230738255130150164357563655579059138547");
		d = new BigInteger("77480200652081242256638629448128804313409178827824165418852595246921056883867957745760518938734648512007711792967912569642307040202351162926509382926519202040516992769393148662366296814878589017630165029022860233421911429456527755860917781810945973831564047064772064231427836904025938091483460614828546266507");
	}
	
	public String criptografa(String senha) {
		return new BigInteger(senha.getBytes()).modPow(e, n).toString();
	}
	public String descriptografa(String criptografia) {
		return new String(new BigInteger(criptografia).modPow(d, n).toByteArray());
	}
}
